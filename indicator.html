<!DOCTYPE html>
<html>
  <head>
    <title>InterviewMate Shortcuts</title>
    <style>
      body {
        margin: 0;
        padding: 8px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        font-size: 11px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        border-radius: 6px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        min-width: 200px;
        user-select: none;
      }

      .status {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 4px;
      }

      .status-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #666;
        transition: background 0.3s ease;
      }

      .status-indicator.recording {
        background: #ff4444;
        box-shadow: 0 0 8px rgba(255, 68, 68, 0.6);
      }

      .shortcuts {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }

      .shortcut {
        display: flex;
        justify-content: space-between;
        align-items: center;
        opacity: 0.8;
      }

      .shortcut.active {
        opacity: 1;
        font-weight: 500;
      }

      .key {
        background: rgba(255, 255, 255, 0.1);
        padding: 2px 4px;
        border-radius: 3px;
        font-size: 10px;
        font-weight: 500;
      }

      .action {
        font-size: 10px;
      }
    </style>
  </head>
  <body>
    <div class="status">
      <div class="status-indicator" id="statusIndicator"></div>
      <span id="statusText">Ready</span>
    </div>
    <div class="shortcuts">
      <div class="shortcut" id="startShortcut">
        <span class="action">Start Recording</span>
        <span class="key">‚åò‚áßS</span>
      </div>
      <div class="shortcut" id="stopShortcut">
        <span class="action">Stop Recording</span>
        <span class="key">‚åò‚áßX</span>
      </div>
      <div class="shortcut">
        <span class="action">Move Window</span>
        <span class="key">‚åò‚Üë‚Üì‚Üê‚Üí</span>
      </div>
      <div class="shortcut">
        <span class="action">Random Position</span>
        <span class="key">‚åòM</span>
      </div>
    </div>

    <script>
      // Use window.electronAPI instead of require since nodeIntegration is false
      const statusIndicator = document.getElementById("statusIndicator");
      const statusText = document.getElementById("statusText");
      const startShortcut = document.getElementById("startShortcut");
      const stopShortcut = document.getElementById("stopShortcut");

      // Listen for IPC messages from main process using electronAPI
      if (window.electronAPI?.onIndicatorUpdate) {
        window.electronAPI.onIndicatorUpdate((event, data) => {
          console.log('üì• [INDICATOR] Received update:', data); // Debug log
          updateIndicator(data);
        });
      } else {
        console.warn('electronAPI not available, falling back to message events');
        window.addEventListener('message', (event) => {
          if (event.data && event.data.type === 'indicator-update') {
            console.log('üì• [INDICATOR] Received update (fallback):', event.data.data);
            updateIndicator(event.data.data);
          }
        });
      }

      function updateIndicator(data) {
        const { isRecording } = data;

        if (isRecording) {
          statusIndicator.classList.add("recording");
          statusText.textContent = "Recording...";
          startShortcut.classList.remove("active");
          stopShortcut.classList.add("active");
        } else {
          statusIndicator.classList.remove("recording");
          statusText.textContent = "Ready";
          startShortcut.classList.add("active");
          stopShortcut.classList.remove("active");
        }
      }

      // Initialize
      updateIndicator({ isRecording: false });
    </script>
  </body>
</html>
